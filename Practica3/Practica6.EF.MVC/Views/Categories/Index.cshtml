@model List<Practica3.EF.Logic.DTOs.CategoriesDto>
@{
    ViewBag.Title = "Categories Page";
}
<link rel="shortcut icon" href="#"/>

<div>
    <h1>CATEGORIAS</h1>
</div>

<table class="table">
    <thead>
        <tr>
            <th scope="col">#</th>
            <th scope="col">Nombre Compañía</th>
            <th scope="col">Descripción</th>
            <th scope="col">Actions</th>
        </tr>
    </thead>
    <tbody class="table-group-divider">
        @foreach (var categories in Model)
        {
            <tr>
                <th scope="row" class="id">@categories.CategoryID</th>
                <td class="categoryName">@categories.CategoryName</td>
                <td class="description">@categories.Description</td>
                <td>
                    @Html.ActionLink("Editar", "EditView", new { id = categories.CategoryID }, "Categories")

                    @*<a href='@Url.Action("", "EditView", new { categoryID = categories.CategoryID }, "Categories")' class="edit" data-toggle="modal">
                        <svg class="material-icons" data-toggle="tooltip" title="Edit" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="25" height="25" viewBox="0,0,256,256">
                            <g fill="#1b7ee3" fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode: normal"><g transform="scale(10.66667,10.66667)"><path d="M18.4,4.4l1.2,1.2l-13.4,13.4h-1.2v-1.2l13.4,-13.4M18.4,2c-0.3,0 -0.5,0.1 -0.7,0.3l-14.7,14.7v4h4l14.7,-14.7c0.4,-0.4 0.4,-1 0,-1.4l-2.6,-2.6c-0.2,-0.2 -0.4,-0.3 -0.7,-0.3z"></path><path transform="translate(0.13311,13.82136) rotate(-45.001)" d="M15.8,4.3h2v4.9h-2z"></path></g></g>
                        </svg>
                    </a>*@
                    <a type="button" class="delete" onclick="deleteCategories(@categories.CategoryID)">
                        <svg class="material-icons" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="25" height="25" viewBox="0,0,256,256">
                            <g fill="#ab2a13" fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode: normal"><g transform="scale(10.66667,10.66667)"><path d="M6,4h12v17h-12z" opacity="0.3"></path><path d="M11,18h-2v-11h2zM15,18h-2v-11h2zM4,3h16v2h-16z"></path><path d="M17,5l-3,-3h-4l-3,3z"></path><path d="M17,22h-10c-1.1,0 -2,-0.9 -2,-2v-17h14v17c0,1.1 -0.9,2 -2,2zM7,5v15h10v-15z"></path></g></g>
                        </svg>
                    </a>
                </td>
            </tr>
        }
    </tbody>
</table>


<div class="col-md-3 offset-md-10">
    <a href='@Url.Action("AddCategoriesView", "Categories")' class="btn btn-success add-new">
        <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="30" height="30" viewBox="0,0,256,256">
            <g fill="#FFFFFF" fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode: normal"><g transform="scale(10.66667,10.66667)"><path d="M12,3c-4.97056,0 -9,4.02944 -9,9c0,4.97056 4.02944,9 9,9c4.97056,0 9,-4.02944 9,-9c0,-4.97056 -4.02944,-9 -9,-9z" opacity="0.3"></path><path d="M12,22c-5.5,0 -10,-4.5 -10,-10c0,-5.5 4.5,-10 10,-10c5.5,0 10,4.5 10,10c0,5.5 -4.5,10 -10,10zM12,4c-4.4,0 -8,3.6 -8,8c0,4.4 3.6,8 8,8c4.4,0 8,-3.6 8,-8c0,-4.4 -3.6,-8 -8,-8z"></path><path d="M11,7h2v10h-2z"></path><path d="M7,11h10v2h-10z"></path></g></g>
        </svg><span> Agregar Categoría</span>
    </a>
</div>
@section Scripts{
    <script type="text/javascript" charset="utf-8">
        function deleteCategories(id) {
            Swal.fire({
                title: '¿Está seguro?',
                text: "¡No podrás revertir esta operación!",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                cancelButtonText: 'Cancelar',
                confirmButtonText: 'Si, Eliminar',
            }).then((result) => {
                if (result.isConfirmed) {
                    confirmDelete(id);
                } else {
                }
            });
        }
       function confirmDelete(id) {
             $.ajax({
                 url: '@Url.Action("Delete", "Categories")',
                 method: 'POST',
                 data: {
                    id: id,
                 },
                 dataType: "json",
                 success: function (data) {
                     if (data.result) {
                        window.location.reload();
                     } else {
                         Swal.fire(
                            'Error',
                            'No se puede eliminar esta categoria, esta asociada a productos.',
                            'error'
                         );
                     }
                    
                 }
                 //error: function (xhr, textStatus, errorThrown) {
                 //    console.error(xhr);
                 //}
            });
       }
    </script>
}
